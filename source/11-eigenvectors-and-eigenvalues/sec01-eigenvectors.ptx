<section xml:id="sec-eigenvectors" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Eigenvectors</title>
    <introduction>
        <p>
            An <term>eigenvector</term> of a square matrix <m>A</m> is a non zero vector whose direction is unchanged when multiplied by <m>A</m>.
            Formally, for a vector <m>v</m>, this relationship is expressed as:
        </p>
        <md>
            <mrow> Av = \lambda v </mrow>
        </md>
        <p>
            Here, <m>\lambda</m> is a scalar known as the <term>eigenvalue</term>
            associated with the eigenvector <m>v</m>.
        </p>
        <p>
            First, we will show how to use Sage to calculate the eigenvalues of a matrix, and then
            we will proceed with the calculations of its eigenvectors.
        </p>
    </introduction>
    <subsection xml:id="subsec-manual-calculation-of-eigenvalues">
        <title>Manual Calculation of Eigenvalues</title>
        <p>
            Since the equation <m> Av = \lambda v </m> is equivalent to <m> (A - \lambda I)v = 0 </m> , the eigenvalues of <m>A</m>
            are precisely the scalars <m>\lambda</m> for which this equation has nontrivial solutions.
            The determinant of the coefficient matrix of this homogeneous system must be zero.
            Therefore, we require <m> \det(A - \lambda I) = 0 </m>.
        </p>
        <p>
            The nth-degree polynomial <m>\det(A - \lambda I)</m> is called the <term>characteristic polynomial</term> of <m>A</m>. The eigenvalues of <m>A</m> are the solutions of the <term>characteristic equation</term>: 
        </p>
        <md>
            <mrow> \det(A - \lambda I) = 0. </mrow>
        </md>
        <p>
            Let's start by solving this equation manually, to calculate the eigenvalues.
            First, we enter our matrix <m>A</m>:
        </p>
        <sage>
            <input>
                A = matrix([
                    [0, 1, 1],
                    [1, 0, 1],
                    [1, 1, 0]
                    ])
                A
            </input>
            <output>
            
            </output>
        </sage>
        <p>
            We declare <m>\lambda</m> as a variable.
        </p>
        <sage>
            <input>
                var('λ')
            </input>
            <output>

            </output>
        </sage>
        <p>
            We then construct the matrix <m>B = A - \lambda I</m>.
        </p>
        <sage>
            <input>
                B = A - λ * identity_matrix(3)
                B
            </input>
            <output>

            </output>
        </sage>
        <p>
            Next, we define the characteristic equation <m>\det(B) = 0</m>.
        </p>
        <sage>
            <input>
                ceq = B.det() == 0
                ceq
            </input>
            <output>

            </output>
        </sage>
        <p>
            Finally, we solve the characteristic equation.
        </p>
        <sage>
            <input>
                solve(ceq)
            </input>
            <output>

            </output>
        </sage>
        <p>
            Sage returns the solution of the equation, which are the eigenvalues of <m>A</m>.
            By using the <c>lhs()</c> method, we obtain the left-hand side part of the equation, namely, the characteristic polynomial.
        </p>
        <sage>
            <input>
                cpoly = ceq.lhs()
                cpoly
            </input>
            <output>

            </output>
        </sage>
        <p>
            Now we factor the characteristic polynomial, so that we can identify each eigenvalue and determine how many times it appears as a root.
            The number of times an eigenvalue occurs as a root of the characteristic polynomial is called its <term>algebraic multiplicity</term>.
        </p>
        <sage>
            <input>
                cpoly.factor()
            </input>
            <output>

            </output>
        </sage>
    </subsection>
    <subsection xml:id="subsec-sage-calculation-of-eigenvalues">
        <title>Sage Calculation of Eigenvalues</title>
        <p>
            Sage provides the <c>eigenvalues()</c> method to compute the eigenvalues directly and return them as a list.
        </p>
        <sage>
            <input>
                A = matrix([
                    [0, 1, 1],
                    [1, 0, 1],
                    [1, 1, 0]
                    ])
                A
                A.eigenvalues()
            </input>
            <output>

            </output>
        </sage>

        <p>
            Observe that we obtained the same eigenvalues as before, each repeated according to its algebraic multiplicity.
        </p>
        <p>
            To calculate the characteristic polynomial, Sage provides the <c>characteristic_polynomial()</c> method.
            Note that this method computes the polynomial
        </p>

        <md>
            <mrow>p = \det(\lambda I - A),</mrow>
        </md>
        
        <p>
            which may differ from our definition of the characteristic polynomial by a sign, depending on the dimension <m>n</m> of the matrix.
            Indeed,
        </p>

        <md>
            <mrow>\det(\lambda I - A) = (-1)^n \det(A - \lambda I).</mrow>
        </md>

        <p>
            To compute the polynomial <m>p</m>, we can use the <c>characteristic_polynomial()</c> or <c>charpoly()</c> methods.
            Using either method will yield the same result.
        </p>

        <sage>
            <input>
                p = A.characteristic_polynomial(var='λ')
                p
            </input>
            <output>

            </output>
        </sage>
        <p>
            We can check now that the characteristic polynomial <em>cpoly</em> we computed by hand before,
            coincides with this polynomial <m>p</m> returned by the <c>characteristic_polynomial()</c> method multiplied by <m>(-1)^n</m>.
        </p>
        <sage>
            <input>
                bool(cpoly == (-1)^3 * p)
            </input>
            <output>

            </output>
        </sage>
        <p>
            Note that if we want to test whether the symbolic expression <m>q</m> is equal to the symbolic expression <m>r</m>, we need to type <c>bool(q == r)</c>.
        </p>
    </subsection>
</section>