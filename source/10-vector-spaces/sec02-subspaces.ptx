<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-subspaces"
    xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Subspaces</title>
    <introduction xml:id="sm-introduction-subspaces">
        <p>
            A subspace of the vector space <m>V</m>
            is a nonempty subset <m>W</m> of <m>V</m>
            such that <m>W</m> is a vector space under
            the same addition and scalar multiplication as on <m>V</m>.
        </p>
        <p>
            For a nonempty subset <m>W</m> of a vector space <m>V</m>,
            to check that <m>W</m> is a subspace of <m>V</m>, 
            we need only verify that <m>W</m> satisfies the closure properties:
        </p>
        <dl>
            <li>
                <title>Addition</title>
                <p>
                    If <m>u, w \in W</m>, then <m>u + w \in W</m>.
                </p>
            </li>
            <li>
                <title>Scalar Multiplication</title>
                <p>
                    If <m>a \in \R</m> and <m>u \in W</m>, then
                    <m>a * u \in W</m>.
                </p>
            </li>
        </dl>
        <p>
            Sage does not provide a way to check if a <em>subset</em> is a subspace. 
            The method <c>is_subspace</c> admits as argument a vector space <m>W</m>
            and check if it is subspace of the ambient space <m>V</m>. 
            In other words, it checks if <m>W</m> is a subset of <m>V</m>.
        </p>
        <sage>
            <input>
                V = VectorSpace(RR, 3)
                W = VectorSpace(RR, 2)
                W.is_subspace(V)
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            We obtained that <m>\R^2</m> is not a subspace of <m>\R^3</m>
            since it is not a subset.
        </p>
        <p>
            Next, we will explore a method for constructing a specific type
            of subspace within a given vector space.
        </p>
    </introduction>
    <subsection xml:id="subsec-spans">
        <title>Spans</title>
        <p>
            A linear combination of a set of vectors <m>\{v1,\dots, v_k\}</m>
            in a vector space <m>V</m> over the field <m>\mathbb F</m>
            is a vector of the form <m>a_1 v_1 + \dots +a_k v_k</m>,
            where <m>a_1,\dots ,a_k \in \mathbb F</m>.
        </p>
        <p>
            For example, let's calculate a linear combination of the vectors 
            <m>u</m> and <m>v</m> in <m>\R^3</m>:
        </p>
        <sage>
            <input>
                u = vector([0, 1/2, 0])
                v = vector([1, -2, 3])
                3*u + 2*v
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            The set of all linear combinations of a set of vectors
            <m>\{v_1,\dots, v_k\}</m> forms a subspace of <m>V</m>
            called the span of <m>\{v_1,\dots, v_k\}</m>,
            denoted <m>\operatorname{span}(\{v_1,\dots, v_k\})</m>.
        </p>
        <p>
            In Sage, the <c>span</c> command can be used to create the span of a set of vectors. 
            Let's find the span of the vectors <m>u</m> and <m>v</m> in <m>\R^3</m>.
        </p>
        <sage>
            <input>
                V = VectorSpace(RR, 3)

                S = V.span([u, v])
                S
            </input>
        </sage>
        <p>
            We can verify that <m>S</m> is a subspace of <m>\R^3</m>:
        </p>
        <sage>
            <input>
                S.is_subspace(V)
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            We can now check if other vectors lie within this span.
            For example, let's test if the vector <m>u = (2, 0, -2)</m>
            is in the span <m>S</m>.
        </p>
        <p>
            Observe that the subspace spanned by the set of vectors 
            <m>u, v</m> and <m>3u + 2v</m> is also <m>S</m>:
        </p>
        <sage>
            <input>
                V = VectorSpace(RR, 3)
                T = V.span([u, v, 3*u + 2*v])
                T
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            We can now check for equality.
        </p>
        <sage>
            <input>
                T == S
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            We see that the new vector added to the generators is redundant. 
            Next, we will see how Sage can detect this redundancy. 
        </p>
    </subsection>
    <subsection xml:id="subsec-linear-independence">
        <title>Linear Independence</title>
        <p>
        The vectors <m>v_1, v_2, \dots ,v_k</m> are <term>linearly dependent</term> if 
        there exist scalars <m>c_1, c_2,\dots , c_k \in \mathbb F</m>, 
        where at least one <m>c_i \neq 0</m>, such that
        </p>
        <md>
            <mrow> c_1 v_1 + c_2 v_2 + \dots + c_n v_k = 0 </mrow>
        </md>
        <p>
            Otherwise, we say these vectors are <term>linearly independent</term>.
        </p>
        <p>
            Sage provides the <c>linear_dependence</c> 
            method to check if a set of vectors is linearly dependent, 
            in a given vector space,
            and in that case outputs the coefficients 
            <m>c_1, c_2, \dots, c_k</m> of the linear combination.
        </p>
        <p>
            We can then test for linear dependence in the context of <m>V</m>.
        </p>
        <sage>
            <input>
                V = VectorSpace(RR, 3)
                v = vector([0, 1/2, 0])
                u = vector([1, -2, 3])
                w = vector([2, -5/2, 6])

                L = [v, u, w]
                V.linear_dependence(L)
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            We obtained a list of coefficients, 
            indicating that the vectors <m>u,v</m> and <m>w</m>
            are linearly dependent and the following combination gives the vector zero:
        </p>
        <md>
            <mrow> 1u + (2/3)v + (-1/3)w = 0 </mrow>
        </md>
        <p>
            Observe that the coefficients in the linear combination are not unique. 
            Sage assigns by default <m>1</m> as the first coefficient. 
        </p>
        <p>
            If the set of vectors is linearly independent, 
            then Sage returns an empty list:
        </p>
        <sage>
            <input>
                S = [u, v] 
                V.linear_dependence(S)
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            We can also check directly for linear independence:
        </p>
        <sage>
            <input>
                V.linear_dependence(S) == []
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            Alternatively, 
            we can manually check if a set of vectors is 
            linearly independent by using the matrix methods studied before.
        </p>
        <note>
            <title>Rank</title>
            The rank of a matrix <m>M</m> is the maximal number of linearly independent
            row vectors (rows viewed as vectors). 
        </note>
        <sage>
            <input>
                # Create a matrix from the vectors
                M = matrix([u,v,w])

                # Check if the rank is equal to the number of vectors
                M.rank() == len(M.rows())
            </input>
            <output>
                
            </output>
        </sage>
        <p>
            The result is <c>True</c>, so the set <m>\{v_1, v_2, v_3\}</m> is linearly independent.
            Now let's consider a linearly dependent set.
        </p>
        <sage>
            <input>
                A = matrix([u, w])
                A = matrix([u1, u2, u3])
                A.rank() == len(A.rows())
            </input>
            <output>
                
            </output>
        </sage>
    </subsection>
    <subsection xml:id="subsec-basis-and-dimensions">
        <title>Basis and Dimensions</title>
        <p>
            A set, <m>B_V</m>, that is a <term>basis</term> of a vector space,
            <m>V</m>, if <m>B_V</m> is both linearly independent and spans the entire space,
            <m>\operatorname{span}(B_V) = V</m>. The number of vectors in a basis is called the
            <term>dimension</term> of the vector space and all sets that form a basis, of the
            same space, are of equal size.
        </p>
        <p>
            Sage implicitly computes the basis and dimension of any subspace with the <c>span</c> command.
            Let's start with a set of vectors that might be linearly dependent and find the basis for the space they span.
        </p>
        <sage>
            <input>
                V = VectorSpace(RR, 4)
                # This set is linearly dependent
                vectors = [
                    vector([ 1,  2,  0,  1]),
                    vector([-1, -2,  0, -1]),
                    vector([ 0,  1,  1,  0]),
                    vector([ 1,  3,  1,  1])
                ]
                S = V.span(vectors)
                S
            </input>
        </sage>
        <p>
            Even though we started with four vectors, the subspace they span is only two dimensional.
            We can see the minimal set of vectors that form the basis for this subspace using the <c>basis</c> command.
        </p>
        <sage>
            <input>
                S.basis()
            </input>
        </sage>
        <p>
            The <c>dimension</c> command simply returns the number of vectors in the basis.
        </p>
        <sage>
            <input>
                S.dimension()
            </input>
        </sage>
    </subsection>

    <p>
        In Sage, we can create a subspace by providing a set of vectors that form a basis for it.
        For example, let's define a subspace of <m>\R^3</m> that is spanned by the vectors
        <m>(1, 2, 3)</m> and <m>(4, 5, 6)</m>.
    </p>
    <sage>
        <input>
            V = VectorSpace(RR, 3)
            W = V.subspace([vector([1, 2, 3]), vector([4, 5, 6])])
            W
        </input>
    </sage>
    <p>
        We can then verify that <m>W</m> is a subspace of <m>V</m>.
    </p>
    <sage>
        <input>
            W.is_subspace(V)
        </input>
    </sage>
</section>
