<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="sec-bases"
    xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Bases</title>
    <introduction xml:id="sm-introduction-coordinates">
        <p> Given a basis for a vector space, any vector in that space can be expressed as a unique
            linear combination of the basis vectors. The coefficients of this linear combination are
            called the <term>coordinates</term> of the vector with respect to that basis. Changing
            from one basis to another is a fundamental operation, and it is accomplished using a <term>change-of-basis
            matrix</term>. </p>
    </introduction>

    <subsection xml:id="subsec-finding-coordinates">
        <title>Finding Coordinates</title>
        <p> If <m>B = \{b_1, b_2, \dots, b_n\}</m> is a basis for a vector space <m>V</m>, and <m>v
            \in V</m>, the coordinate vector of <m>v</m> with respect to <m>B</m>, denoted <m>[v]_B</m>,
            is the unique vector of scalars <m>(c_1, c_2, \dots, c_n)</m> such that <me>v = c_1 b_1
            + c_2 b_2 + \dots + c_n b_n</me> This equation can be rewritten in matrix form as <m>v =
            P_B \big([v]_B\big)</m>, where <m>P_B</m> is the matrix whose columns are the basis
            vectors from <m>B</m>. To find the coordinates, we solve for <m>[v]_B</m> using, <m>[v]_B
            = P_B^{-1} v</m>. </p>
        <p> Let's find the coordinates of the vector <m>v = (4, -3)</m> with respect to the basis <m>B
            = \{(1, 1), (1, -1)\}</m>. </p>
        <sage>
            <input>
                v = vector([4, -3])
                b1 = vector([1, 1])
                b2 = vector([1, -1])

                # Create the matrix with basis vectors as columns
                P_B = matrix([b1, b2]).transpose()

                # Solve the system P_B * c = v for the coordinate vector c
                v_B = P_B.solve_right(v)
                v_B
            </input>
        </sage>
        <p> So, <m>[v]_B = (1/2, 7/2)</m>. </p>
    </subsection>

    <subsection xml:id="subsec-change-of-basis-">
        <title>Change of Basis</title>
        <p> Often we need to convert the coordinates of a vector from one basis <m>B</m> to another
            basis <m>C</m>. This is done using a change-of-basis matrix, <m>P_{C \leftarrow B}</m>.
            The conversion formula is: <me>[v]_C = P_{C \leftarrow B} \big([v]_B\big)</me> The
            change-of-basis matrix from <m>B</m> to <m>C</m> is given by <m>P_{C \leftarrow B} =
            P_C^{-1} \circ P_B</m>. </p>
        <p> Let's use the basis <m>B</m> from before and a new basis <m>C = \{(2, 1), (1, 0)\}</m>.
            We already know <m>[v]_B = (1/2, 7/2)</m>. Let's find <m>[v]_C</m> using a
            change-of-basis matrix. </p>
        <sage>
            <input>
                v_B = vector([0.5, 3.5])

                # Define basis C and its matrix P_C
                c1 = vector([2, 1])
                c2 = vector([1, 0])
                P_C = matrix([c1, c2]).transpose()

                # Calculate the change-of-basis matrix from B to C
                P_C_inv = P_C.inverse()
                P_C_from_B = P_C_inv * P_B

                # Calculate the new coordinates
                v_C = P_C_from_B * v_B
                v_C
            </input>
        </sage>
        <p>
            Let's verify this by solving for the coordinates directly:
        </p>
        <sage>
            <input>
                v = vector([4, -3])
                P_C.solve_right(v)
            </input>
        </sage>
    </subsection>
</section>
